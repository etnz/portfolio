{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Portfolio Securities Data",
  "description": "A collection of securities, indexed by their ticker symbol.",
  
  "type": "object",
  "comment": "The root is an object where each property is a ticker.",
  
  "additionalProperties": {
    "$ref": "#/definitions/security"
  },

  "definitions": {
    "security": {
      "type": "object",
      "description": "Represents a single security with its ID and price history.",
      "properties": {
        "id": {
          "type": "string",
          "description": "The unique identifier of the security (e.g., ISIN)."
        },
        "history": {
          "$ref": "#/definitions/priceHistory"
        }
      },
      "required": ["id", "history"]
    },
    "priceHistory": {
      "type": "object",
      "description": "An object where keys are dates (YYYY-MM-DD) and values are prices.",
      "patternProperties": {
        "^\\d{4}-\\d{2}-\\d{2}$": {
          "type": "number",
          "description": "The security price on that date."
        }
      },
      "additionalProperties": false,
      "comment": "The patternProperties enforces YYYY-MM-DD format for keys. additionalProperties:false prevents non-date keys."
    }
  }
}